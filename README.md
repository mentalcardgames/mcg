# MCG Visual Unified

A unified visual interface for the Mental Card Games project.

## Overview

`mcg_visual_unified` is a library that provides a visual interface for card game applications. It combines the functionality of the previous `mcg_visual` library and the WASM template implementation into a single, cohesive crate.

## Features

- Card rendering and management
- Game field layouts
- Drag and drop interactions
- Screen management system
- WASM compatibility for web deployment
- Pre-loaded card decks (no directory selection required)

## Running the WASM Frontend

To run the WASM frontend in a browser:

### Option 1: One-step build and serve (Recommended)

```bash
cd mcg_visual_unified
chmod +x start.sh
./start.sh
```

This will build the WASM package and start a local web server in one step.

### Option 2: Manual steps

1. Build the WASM package:
   ```bash
   cd mcg_visual_unified
   chmod +x wasm-build.sh
   ./wasm-build.sh
   ```

2. Start a simple HTTP server to serve the files:
   ```bash
   # Using the provided script:
   chmod +x serve.sh
   ./serve.sh
   
   # Or manually:
   python -m http.server 8080
   # Or with Node.js:
   # npx http-server -p 8080
   ```

3. Open your browser and navigate to http://localhost:8080/

This will run the application in your browser, allowing you to interact with the card game interface. The application comes with pre-loaded card decks, so you don't need to select a directory of card images.

### Directory Structure for WASM

For the WASM version to work correctly, maintain this structure:
```
mcg_visual_unified/
├── index.html     # The HTML entry point
├── pkg/           # Generated by wasm-pack
├── media/         # Media assets for cards
│   ├── img_cards/ # Standard card images (pre-loaded)
│   └── alt_cards/ # Alternative card designs (pre-loaded)
```

## Usage

Add this crate to your dependencies:

```toml
[dependencies]
mcg_visual_unified = { path = "../path/to/mcg_visual_unified" }
```

### Web/WASM Usage

To use this in a web application:

```rust
use mcg_visual_unified::start;

// In your JavaScript:
// import init, {start} from './pkg/mcg_visual_unified.js';
// 
// async function run() {
//     await init();
//     start(document.getElementById("my_canvas"));
// }
// 
// run();
```

Your HTML file should include:
```html
<canvas id="my_canvas"></canvas>
<script type="module">
    import init, {start} from './pkg/mcg_visual_unified.js';

    async function run() {
        await init();
        start(document.getElementById("my_canvas"));
    }

    run();
</script>
```

### Desktop Usage

For desktop applications, you can use the eframe integration:

```rust
use mcg_visual_unified::game::App;
use eframe::{NativeOptions, run_native};

fn main() {
    let app = App::default();
    let options = NativeOptions::default();
    run_native("My Card Game", options, Box::new(|_cc| Box::new(app)));
}
```

## Using the Application

When running the application:

1. Click the "Start" button in the main menu
2. You'll see the standard deck is already loaded
3. Set the number of players using the controls
4. Click "Start Game" to begin the game

To use the alternative card designs, click "Drag & Drop Game" in the main menu instead of "Start".

## Development Workflow

1. Make changes to the code
2. Either:
   - Run `./start.sh` to rebuild and serve in one step, or
   - Run `./wasm-build.sh` to rebuild the WASM package and then run `./serve.sh` to start a local web server (if not already running)
3. Refresh your browser to see the changes

## License

Dual-licensed under MIT and Apache-2.0.