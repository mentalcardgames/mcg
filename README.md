# MCG

A mental card game implementation in the browser.

## Features

- Card rendering and management
- Game field layouts
- Drag and drop interactions
- Screen management system
- WASM compatibility for web deployment

## Adding New Screens

To add a new screen to the application:

1. **Add screen type and metadata** in `client/src/game/screens/mod.rs`:
   ```rust
   // Add to ScreenType enum
   MyNewScreen,
   
   // Add metadata in metadata() method
   ScreenType::MyNewScreen => ScreenMetadata {
       display_name: "My New Screen",
       icon: "ðŸ†•",
       url_path: "/my-new-screen",
       description: "Description of what this screen does",
       show_in_menu: true,  // Show in main menu?
   },
   
   // Add to all_screens() method
   ScreenType::MyNewScreen,
   
   // Add to create_screen() method
   ScreenType::MyNewScreen => MyNewScreen::create(),
   ```

2. **Create screen implementation** (e.g., `my_new_screen.rs`):
   ```rust
   use super::{AppInterface, ScreenWidget, ScreenFactory};
   
   pub struct MyNewScreen { /* state */ }
   
   impl ScreenWidget for MyNewScreen {
       fn ui(&mut self, app_interface: &mut AppInterface, ui: &mut egui::Ui, _frame: &mut Frame) {
           // Your UI code here
       }
   }
   
   impl ScreenFactory for MyNewScreen {
       fn create() -> Box<dyn ScreenWidget> {
           Box::new(MyNewScreen::new())
       }
   }
   ```

3. **Register in App** in `client/src/game.rs`:
   ```rust
   // Add field to App struct
   my_new_screen: MyNewScreen,
   
   // Add to App::new()
   my_new_screen: MyNewScreen::new(),
   
   // Add to match in update()
   ScreenType::MyNewScreen => self.my_new_screen.ui(&mut app_interface, ui, frame),
   ```

The screen will automatically:
- Appear in the main menu (if `show_in_menu: true`)
- Handle URL routing at the specified path
- Show the top bar with back button
- Work with browser forward/back buttons

## Running the WASM Frontend


### Build and serve with just

Use the included justfile (install `just` from your package manager).

```bash
# Build the WASM package (release)
just build

# Or build in dev mode (faster, larger wasm)
just build dev

# Serve the current directory on http://localhost:8080
just serve

# Build then serve in one step
just start
# Or: just start dev
# Or: just start 8080 dev
```

Then open your browser and navigate to http://localhost:8080/

## Workspace layout

This repo is a Cargo workspace with three crates:

- client/ â€” WASM/egui frontend and all UI/game/screens code.
- server/ â€” Axum-based WebSocket backend for the poker demo.
- shared/ â€” Data types shared by client and server (protocol and communication).

The old root crate has been removed; the top-level `src/` is empty and no longer used.

### Directory Structure for WASM

For the WASM version to work correctly, maintain this structure:
```
mcg/
â”œâ”€â”€ index.html     # The HTML entry point
â”œâ”€â”€ pkg/           # Generated by wasm-pack
â”œâ”€â”€ media/         # Media assets for cards
â”‚   â”œâ”€â”€ img_cards/ # Standard card images
â”‚   â””â”€â”€ alt_cards/ # Alternative card designs
```


## Development Workflow

1. Make changes to the code
2. Run `just build dev` to rebuild the WASM package (dev makes the
   compilation faster, but the binary bigger) and then run `just serve` to start
   a local web server (if not already running)
3. Refresh your browser to see the changes

## License

Dual-licensed under MIT and Apache-2.0.
